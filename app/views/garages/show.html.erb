<div class="valign-wrapper whole-page">
  <div class="row valign whole-width">
    <%= form_tag pages_next_url(@booking), :length => params[:length] do %>
        
        Coordinates of current garage: <%= @coordinate %>

        <div style='width: 800px;'>
          <div id="map" style='width: 800px; height: 400px;'></div>
        </div>

        <div class="input-field">
          <%= label :length, "How long will you stay?" %>
          <br/><br/>
          <%= select_tag "length", options_for_select(@garage_times.map { |obj| [obj['time'], obj['value']] }) %>
        </div>

        <%= hidden_field_tag :garageid, @garage.id %>

        <!--<%= submit_tag 'Save', class: "btn" %>-->
  
        <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
                data-key= "<%= Rails.application.secrets.stripe_publishable_key %>"
                data-description= "Parking Spot Payment"
                data-amount= 
                <%= 
                  if DateTime.now.on_weekend?
                    @garage.weekend*100 #*params[:length] #need dynamic jquery to fetch in length   
                  else
                    @garage.weekday*100 #*params[:length]   
                  end
                %>
                data-locale="auto"
                data-email= <%= current_user.email %> ></script>
    <% end %>
  </div>
</div>

<script type="text/javascript">  
handler = Gmaps.build('Google');  
handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){  
  markers = handler.addMarkers([  
    {  
      "lat": <%= @coordinate.at(0) %>,  
      "lng": <%= @coordinate.at(1) %>,  
      "picture": {  
        "width":  32,  
        "height": 32  
      },  
      "infowindow": "<%= @garage_name %>"  
    }  
  ]);  
  handler.bounds.extendWith(markers);  
  handler.fitMapToBounds();  
});  
</script>

<!-- 
===== Use Testing CC value ======
4242424242424242	Visa
4000056655665556	Visa (debit)
5555555555554444	Mastercard
5200828282828210	Mastercard (debit)
5105105105105100	Mastercard (prepaid)
378282246310005	American Express
371449635398431	American Express
6011111111111117	Discover
6011000990139424	Discover
30569309025904	Diners Club
38520000023237	Diners Club
3530111333300000	JCB
-->
